---
title: .git è³‡æ–™å¤¾å…§çš„ç§˜å¯† - 1
date: 2021-04-16
sidebar: 'auto'
categories:
    - tool
    - f2e
tags:
    - git
---

## å‰è¨€

åœ¨æˆ‘å€‘é–‹å§‹èªªæ˜ .git å…§çš„å«ç¾©å‰ï¼Œ<br>
å…ˆä¾†æ“ä½œä¸Šä¸€ç¯‡ Demo ç”¨çš„ try-git å…§å®¹è®ŠåŒ–ä¾†è§€å¯Ÿ .git å…§æœ‰ä»€éº¼è®Šå‹•ï¼Œ<br>
é€™æ¨£ä¾†èªªæ˜æ˜¯æœ€æœ‰æ„Ÿçš„ï½

## å¯¦ä½œï¼šgit add æª”æ¡ˆ

### å‰æƒ…æè¦

ä¸Šä¸€å›æˆ‘å€‘è®“å°ˆæ¡ˆåˆå§‹åŒ– git ä¸¦ç™¼ç¾è‡ªå‹•ç”¢ç”Ÿ .git è³‡æ–™å¤¾

### å°ˆæ¡ˆç‹€æ…‹

```bash
> git status

# ç›®å‰å°ˆæ¡ˆé‚„æœ‰æ²’åšä»»ä½•çš„ commit
No commits yet
```

### å°ˆæ¡ˆè®Šå‹•å¾Œï¼šå°ˆæ¡ˆç‹€æ…‹ & .git çš„è®ŠåŒ–

å°ˆæ¡ˆæ–°å¢æª”æ¡ˆå¾Œï¼Œgit é¦¬ä¸Šè¿½è¹¤åˆ°æœ‰æ–°æª”æ¡ˆä½† .git é‚„æ˜¯æ²’æœ‰ç™¼ç”Ÿæ”¹è®Š

```bash
# æ–°å¢æª”æ¡ˆ
> echo 'add README.md' > README.md

# å°ˆæ¡ˆç‹€æ…‹
> git status

No commits yet
Untracked files:
  (use "git add <file>..." to include in what will be committed)
	README.md

# æŸ¥çœ‹ .git
> tree .git

.git
â”œâ”€â”€ HEAD
â”œâ”€â”€ config
â”œâ”€â”€ description
â”œâ”€â”€ hooks
â”‚Â Â  â”œâ”€â”€ applypatch-msg.sample
â”‚Â Â  â”œâ”€â”€ commit-msg.sample
â”‚Â Â  â”œâ”€â”€ fsmonitor-watchman.sample
â”‚Â Â  â”œâ”€â”€ post-update.sample
â”‚Â Â  â”œâ”€â”€ pre-applypatch.sample
â”‚Â Â  â”œâ”€â”€ pre-commit.sample
â”‚Â Â  â”œâ”€â”€ pre-merge-commit.sample
â”‚Â Â  â”œâ”€â”€ pre-push.sample
â”‚Â Â  â”œâ”€â”€ pre-rebase.sample
â”‚Â Â  â”œâ”€â”€ pre-receive.sample
â”‚Â Â  â”œâ”€â”€ prepare-commit-msg.sample
â”‚Â Â  â””â”€â”€ update.sample
â”œâ”€â”€ info
â”‚Â Â  â””â”€â”€ exclude
â”œâ”€â”€ objects
â”‚Â Â  â”œâ”€â”€ info
â”‚Â Â  â””â”€â”€ pack
â””â”€â”€ refs
    â”œâ”€â”€ heads
    â””â”€â”€ tags

8 directories, 16 files
```

### åŠ å…¥ç‰ˆæ§è¿½è¹¤å¾Œçš„è®ŠåŒ–

`.git/objects` ç›®éŒ„ä¸‹å¤šäº†ä¸€å€‹å­ç›®éŒ„å’Œä¸€å€‹æª”æ¡ˆï¼š.git/objects/ad/6bc9244802a60f632422717a95f1cb0931fa5a

```bash
# å°‡æ‰€æœ‰è®ŠåŒ–éƒ½åŠ å…¥ç‰ˆæ§
> git add .

# æŸ¥çœ‹ .git
> tree .git

# åªé¡¯ç¤ºæœ‰è®ŠåŒ–çš„å…§å®¹
.git
â”œâ”€â”€ objects
â”‚Â Â  â”œâ”€â”€ ad
â”‚Â Â  â”‚Â Â  â””â”€â”€ 6bc9244802a60f632422717a95f1cb0931fa5a
â”‚Â Â  â”œâ”€â”€ info
â”‚Â Â  â””â”€â”€ pack
â””â”€â”€ refs
    â”œâ”€â”€ heads
    â””â”€â”€ tags

9 directories, 18 files
```

### æˆ‘å€‘ä¾†é–‹å•Ÿå‰›å‰›å»ºç«‹çš„æª”æ¡ˆ

ä½¿ç”¨ cat ä¾†é–‹å•Ÿæª”æ¡ˆï¼Œæœƒç™¼ç¾å…§å®¹ç‚ºäº‚ç¢¼

```bash
> cat .git/objects/ad/6bc9244802a60f632422717a95f1cb0931fa5a

xK??OR04aHLIrut?u??M?J%%
```

é€™ä¸€ä¸²åˆ°åº•æ˜¯ä»€éº¼ï¼ŸğŸ§

## ç­‰ç­‰ï¼Git æ€éº¼å„²å­˜æª”æ¡ˆï¼Ÿ

### git hash-object

Git å„²å­˜å…§å®¹æ˜¯é€é git hash-object å–å¾— SHA1 å„²å­˜èµ·ä¾†<br>

ç„¶å¾Œåœ¨æŠŠç”¢ç”Ÿå‡ºä¾†çš„ SHA1 æ”¾ç½®åœ¨ .git/objects è³‡æ–™å¤¾åº•ä¸‹<br>

-   å‰é¢ 2 å€‹æ•¸å­— or å­—æ¯åˆ‡å‡ºä¾†ç•¶æˆè³‡æ–™å¤¾
-   å‰©é¤˜ç•¶æˆæª”å

æˆ‘å€‘ä½¿ç”¨å‰›å‰›å»ºç«‹ README.md å…§å®¹ç¤ºç¯„

```bash
> echo 'add README.md'  | git hash-object --stdin
ad6bc9244802a60f632422717a95f1cb0931fa5a

# è³‡æ–™å¤¾ï¼šad
# æª”åï¼š6bc9244802a60f632422717a95f1cb0931fa5a

# æ ¸å°ä¸€ä¸‹å‰›å‰›ä½¿ç”¨ tree .git è³‡æ–™çµæ§‹å…§å®¹
# çœ‹èµ·ä¾†å®Œå…¨ç¬¦åˆï¼
â”œâ”€â”€ objects
â”‚Â Â  â”œâ”€â”€ ad
â”‚Â Â  â”‚Â Â  â””â”€â”€ 6bc9244802a60f632422717a95f1cb0931fa5a
```

### git cat-file

å¥½ï¼Œæˆ‘å€‘çŸ¥é“ git æ€éº¼å°‡æª”æ¡ˆåŠ å…¥ç‰ˆæ§ï¼Œ
ä½†å‰›å‰›æˆ‘å€‘ä½¿ç”¨ cat ä¾†é–‹å•Ÿæª”æ¡ˆæœƒç™¼ç¾å…§å®¹ç‚ºäº‚ç¢¼ï¼Œ<br>
é€™åˆè©²æ€éº¼è§£æ±ºå‘¢ï¼Ÿ

å› ç‚º git ç”¨äºŒé€²åˆ¶çš„æ–¹å¼å°‡å…§å®¹å„²å­˜èµ·ä¾†
æ‰€ä»¥æˆ‘å€‘è¦ä½¿ç”¨ git ä¾†æŸ¥çœ‹æª”æ¡ˆçœŸæ­£çš„å…§å®¹

```bash
# ä½¿ç”¨ cat æœƒé¡¯ç¤ºäº‚ç¢¼
> cat .git/objects/ad/6bc9244802a60f632422717a95f1cb0931fa5a

xK??OR04aHLIrut?u??M?J%%

# ä½¿ç”¨ git cat-file æŸ¥çœ‹æª”æ¡ˆ
> git cat-file ad6bc9244802a60f632422717a95f1cb0931fa5a -p
add README.md
```

å¤ªå¥½æƒ¹ï¼
å‰›å‰›çš„ç–‘æƒ‘çµ‚æ–¼è§£é–‹æƒ¹ï½
è®“æˆ‘å€‘ä¼‘æ¯ä¸€ä¸‹ï¼Œä¸‹ä¸€ç¯‡å†ç¹¼çºŒ ğŸŒ
